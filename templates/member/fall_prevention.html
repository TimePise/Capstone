{% extends "member/base.html" %}
<!-- prettier-ignore-start -->
{% block title %}ë‚™ìƒ ê°ì§€ ì‹œìŠ¤í…œ{% endblock %}
<!-- prettier-ignore-end -->

{% block content %}
<h2>ë‚™ìƒ ê°ì§€ ì‹œìŠ¤í…œ</h2>

<!-- ì¹´ë©”ë¼ & ë²„íŠ¼ ë˜í¼ -->
<div
  id="camera-wrapper"
  style="
    position: relative;
    width: 800px;
    height: 500px;
    background: black;
    margin-bottom: 20px;
  "
>
  <img
    src="{% url 'pose_estimation_feed' %}"
    style="width: 100%; height: 100%; object-fit: cover"
  />

  <!-- ë³´í˜¸ëª¨ë“œ ë²„íŠ¼ -->
  <button
    id="privacy-btn"
    style="
      position: absolute;
      top: 10px;
      left: 10px;
      padding: 6px 10px; /* âœ… ì‚¬ì´ì¦ˆ ì¤„ì´ê¸° */
      font-size: 12px; /* âœ… ê¸€ì í¬ê¸° ì¤„ì´ê¸° */
      background: purple;
      color: white;
      border: none;
      border-radius: 4px; /* âœ… ë‘¥ê¸€ê²Œ (optional) */
      cursor: pointer;
    "
  >
    ë³´í˜¸ëª¨ë“œ
  </button>

  <!-- í…ŒìŠ¤íŠ¸ ì•Œë¦¼ ë²„íŠ¼ -->
  <button
    id="alert-btn"
    style="
      position: absolute;
      top: 10px;
      right: 10px;
      padding: 6px 10px;
      font-size: 12px;
      background: orange;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    "
  >
    í…ŒìŠ¤íŠ¸ ì•Œë¦¼
  </button>
</div>

<!-- âœ… Toastr ìŠ¤íƒ€ì¼ CDN ì¶”ê°€ -->
<link
  href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css"
  rel="stylesheet"
/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>

<script>
  toastr.options = {
    closeButton: true,
    progressBar: true,
    positionClass: "toast-top-right",
    timeOut: "1500",
  };

  // ë³´í˜¸ëª¨ë“œ ë²„íŠ¼ í´ë¦­ ì‹œ
  document.getElementById("privacy-btn").addEventListener("click", function () {
    fetch("{% url 'toggle_privacy_mode' %}")
      .then((res) => res.json())
      .then((data) => {
        if (data.privacy_mode) {
          toastr.success("ğŸ”’ ë³´í˜¸ëª¨ë“œê°€ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤");
        } else {
          toastr.info("ğŸ”“ ë³´í˜¸ëª¨ë“œê°€ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤");
        }
      });
  });

  // í…ŒìŠ¤íŠ¸ ì•Œë¦¼ ë²„íŠ¼ í´ë¦­ ì‹œ
  document.getElementById("alert-btn").addEventListener("click", function () {
    fetch("{% url 'test_fall_alert' %}", {
      method: "POST",
      headers: {
        "X-CSRFToken": "{{ csrf_token }}",
      },
    })
      .then((res) => res.json())
      .then((data) => {
        toastr.warning("ğŸ“¢ " + data.status);
      });
  });
</script>
{% endblock %}
