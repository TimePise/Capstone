{% extends "member/base.html" %} {% load static %} {% block title %}홈{% endblock %}
{% block body_class %}home-body{% endblock %}
{% block content %}
<style>
  .home-body {
    background-color: #0f172a;
  }

  .home-section {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 120px 20px 80px;
    color: #fff;
    background: radial-gradient(circle at top, rgba(99, 102, 241, 0.25), transparent 50%),
      radial-gradient(circle at bottom, rgba(16, 185, 129, 0.2), transparent 55%),
      url("{% static 'images/hospital_hallway.png' %}") center/cover no-repeat;
    position: relative;
    overflow: hidden;
  }

  .home-section::before {
    content: "";
    position: absolute;
    inset: 0;
    background: rgba(15, 23, 42, 0.55);
    backdrop-filter: blur(2px);
  }

  .hero-content,
  .feature-grid,
  .cta-panel {
    position: relative;
    z-index: 1;
    width: 100%;
    max-width: 1200px;
  }

  .hero-content {
    text-align: center;
    margin-bottom: 60px;
    animation: fadeSlide 0.9s ease forwards;
  }

  .hero-title {
    font-size: clamp(2.8rem, 5vw, 4rem);
    font-weight: 700;
    margin-bottom: 18px;
    letter-spacing: -0.02em;
  }

  .hero-subtitle {
    font-size: 1.15rem;
    color: #e0e7ff;
    max-width: 900px;
    margin: 0 auto;
    line-height: 1.3;
  }

  .feature-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: 24px;
    margin-bottom: 50px;
  }

  .feature-card {
    background: rgba(255, 255, 255, 0.08);
    border: 1px solid rgba(255, 255, 255, 0.12);
    border-radius: 24px;
    padding: 28px 24px;
    color: #f8fafc;
    backdrop-filter: blur(6px);
    box-shadow: 0 20px 40px rgba(15, 23, 42, 0.4);
    transition: transform 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease,
      background 0.3s ease;
    position: relative;
    overflow: hidden;
  }

  .feature-card::after {
    content: "";
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at top right, rgba(129, 140, 248, 0.35), transparent 55%);
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .feature-card:hover {
    transform: translateY(-8px) scale(1.01);
    border-color: rgba(129, 140, 248, 0.7);
    box-shadow: 0 30px 60px rgba(79, 70, 229, 0.35);
  }

  .feature-card:hover::after {
    opacity: 1;
  }

  .feature-card h3 {
    font-size: 1.2rem;
    margin-bottom: 8px;
    position: relative;
    z-index: 1;
  }

  .feature-card p {
    font-size: 0.95rem;
    color: #cbd5f5;
    line-height: 1.5;
    position: relative;
    z-index: 1;
  }

  .cta-panel {
    background: rgba(15, 23, 42, 0.72);
    border-radius: 28px;
    padding: 32px;
    border: 1px solid rgba(148, 163, 184, 0.4);
    box-shadow: 0 25px 45px rgba(15, 23, 42, 0.65);
    text-align: center;
    animation: pulseGlow 4s ease-in-out infinite;
  }

  .cta-panel h2 {
    font-size: 2rem;
    margin-bottom: 12px;
  }

  .cta-panel p {
    color: #cbd5f5;
    margin-bottom: 24px;
    line-height: 1.5;
  }

  .action-buttons {
    display: flex;
    flex-wrap: wrap;
    gap: 16px;
    justify-content: center;
  }

  .action-buttons a {
    min-width: 200px;
    padding: 14px 24px;
    border-radius: 999px;
    font-weight: 600;
    text-decoration: none;
    color: #0f172a;
    background: linear-gradient(135deg, #38bdf8, #818cf8);
    box-shadow: 0 15px 30px rgba(99, 102, 241, 0.35);
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }

  .action-buttons a.secondary {
    background: rgba(255, 255, 255, 0.92);
    color: #1f2937;
    box-shadow: 0 12px 25px rgba(15, 23, 42, 0.4);
  }

  .action-buttons a:hover {
    transform: translateY(-4px);
    box-shadow: 0 20px 35px rgba(99, 102, 241, 0.45);
  }

  .status-widget {
    width: 100%;
    max-width: 420px;
    margin: 0 auto 40px;
    padding: 18px 22px;
    border-radius: 18px;
    background: rgba(255, 255, 255, 0.12);
    border: 1px solid rgba(255, 255, 255, 0.2);
    text-align: center;
    backdrop-filter: blur(6px);
    color: #f8fafc;
    position: relative;
    overflow: hidden;
  }

  .status-widget::after {
    content: "";
    position: absolute;
    inset: 0;
    background: radial-gradient(circle, rgba(14, 165, 233, 0.3), transparent 70%);
    opacity: 0.4;
    pointer-events: none;
  }

  .status-widget strong {
    font-size: 1.05rem;
  }

  .status-value {
    display: block;
    margin-top: 6px;
    font-size: 1.4rem;
    font-weight: 600;
  }

  .status-safe {
    color: #34d399;
  }

  .status-alert {
    color: #f87171;
  }

  @media (max-width: 768px) {
    .hero-title {
      font-size: 2.2rem;
    }
    .hero-subtitle {
      font-size: 1rem;
    }
    .feature-grid {
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    }
    .cta-panel {
      padding: 24px;
    }
    .action-buttons a {
      min-width: 160px;
      padding: 12px 18px;
    }
  }

  @keyframes fadeSlide {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes pulseGlow {
    0%,
    100% {
      box-shadow: 0 25px 45px rgba(15, 23, 42, 0.65);
    }
    50% {
      box-shadow: 0 30px 55px rgba(99, 102, 241, 0.35);
    }
  }
</style>

<section class="home-section">
  <div class="hero-content">
    <p class="hero-title">환자 안전을 위한 실시간 낙상 감지 시스템</p>
    <p class="hero-subtitle">24시간 감시 · 즉각 알림 · 데이터 기반 대응으로 의료진의 대응 시간을 줄입니다.</p>
  </div>

  <div class="status-widget" id="statusWidget">
    <strong>현재 감지 상태</strong>
    <span class="status-value">로딩 중...</span>
  </div>

  <div class="feature-grid">
    <div class="feature-card">
      <h3>초당 감지 & 알림</h3>
      <p>실시간 포즈 분석으로 낙상 패턴을 탐지하고 즉시 알림을 발송합니다.</p>
    </div>
    <div class="feature-card">
      <h3>이력 기반 분석</h3>
      <p>낙상 기록을 바탕으로 공통 위험 구간을 파악하고 예방 전략을 세웁니다.</p>
    </div>
    <div class="feature-card">
      <h3>프라이버시 보호</h3>
      <p>개인영상 보호 모드를 지원해, 필요 시 포즈 라인만 남기고 화면을 가립니다.</p>
    </div>
    <div class="feature-card">
      <h3>협업 알림</h3>
      <p>여러 디바이스에서 동시에 알림을 받아 팀 단위 대응이 가능합니다.</p>
    </div>
  </div>

  <div class="cta-panel">
    <h2>지금 바로 환자의 안전을 확인하세요</h2>
    <p>감지 화면에서 실시간 상태를 확인하고, 알림 페이지에서 조치 내역을 관리할 수 있습니다.</p>
    <div class="action-buttons">
      {% if m_id %}
      <a href="{% url 'fall_prevention' %}">감지 화면 바로가기</a>
      <a href="{% url 'fall_record_list' %}" class="secondary">낙상 이력 보기</a>
      {% else %}
      <a href="{% url 'member_login' %}">로그인하고 시작하기</a>
      <a href="{% url 'member_reg' %}" class="secondary">회원가입</a>
      {% endif %}
    </div>
  </div>
</section>
<script>
  (function () {
    const widget = document.getElementById("statusWidget");
    if (!widget) return;
    const valueEl = widget.querySelector(".status-value");

    async function fetchStatus() {
      try {
        const res = await fetch("{% url 'fall_status' %}");
        if (!res.ok) throw new Error("status error");
        const data = await res.json();
        valueEl.textContent = data.label || "정상입니다";
        valueEl.classList.toggle("status-alert", data.fall);
        valueEl.classList.toggle("status-safe", !data.fall);
      } catch (err) {
        valueEl.textContent = "상태 정보를 불러오지 못했습니다.";
        valueEl.classList.remove("status-alert", "status-safe");
      }
    }

    fetchStatus();
    setInterval(fetchStatus, 5000);
  })();
</script>
{% endblock %}
